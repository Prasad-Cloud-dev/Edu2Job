<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Dashboard</title>

  <!-- Styles -->
  <link rel="stylesheet" href="profile.css" />
  <link rel="stylesheet" href="predict.css">

  <!-- Scripts (load order matters: core, helpers, then features) -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="predict.js" defer></script>
  <script src="visualizations.js" defer></script>
  <script src="history.js" defer></script>
  <script src="profile.js" defer></script>

  <style>
    :root {
      --bg: #f5f7fa;
      --sidebar-bg: #ffffffcc;
      --sidebar-border: #e0e6ef;
      --primary: #6366f1;
      --primary-hover: #4f46e5;
      --accent: #06b6d4;
      --gradient: linear-gradient(135deg, #6366f1, #06b6d4);
      --text-dark: #111827;
      --text-light: #6b7280;
      --card-bg: #ffffffcc;
      --card-border: #e5e7eb;
    }
    body {
      font-family: "Inter","Segoe UI",Roboto,sans-serif;
      margin:0;
      display:flex;
      height:100vh;
      background:var(--bg);
      color:var(--text-dark);
    }
    .sidebar {
      width:250px;
      background:var(--sidebar-bg);
      backdrop-filter:blur(12px);
      border-right:1px solid var(--sidebar-border);
      display:flex;
      flex-direction:column;
      padding:24px;
      justify-content:space-between;
      box-shadow:4px 0 12px rgba(0,0,0,0.05);
    }
    .sidebar h2 {
      margin-bottom:24px;
      font-size:20px;
      font-weight:700;
      background:var(--gradient);
      -webkit-background-clip:text;
      -webkit-text-fill-color:transparent;
    }
    .menu { flex-grow:1; }
    .sidebar button {
      background:none;
      border:none;
      color:var(--text-dark);
      text-align:left;
      padding:12px 14px;
      cursor:pointer;
      font-size:15px;
      margin-bottom:10px;
      border-radius:12px;
      transition:all .3s ease;
      width:100%;
      display:flex;
      align-items:center;
      gap:10px;
    }
    .sidebar button:hover {
      background:var(--gradient);
      color:#fff;
      transform:translateX(6px);
      box-shadow:0 4px 12px rgba(99,102,241,0.25);
    }
    .bottom-menu {
      border-top:1px solid var(--sidebar-border);
      padding-top:16px;
    }
    .main {
      flex:1;
      padding:40px;
      overflow-y:auto;
      animation:fadeIn .6s ease;
    }
    @keyframes fadeIn {
      from {opacity:0; transform:translateY(10px);}
      to {opacity:1; transform:translateY(0);}
    }
    .welcome {
      background:var(--gradient);
      color:white;
      padding:28px;
      border-radius:16px;
      box-shadow:0 6px 14px rgba(99,102,241,0.3);
      margin-bottom:30px;
      animation:fadeIn .8s ease;
    }
    .welcome h2 { margin:0 0 8px; font-size:26px; }
    .welcome p { margin:0; font-size:15px; opacity:.9; }
    .dashboard-grid {
      display:grid;
      grid-template-columns:repeat(auto-fill,minmax(260px,1fr));
      gap:24px;
    }
    .card {
      background:var(--card-bg);
      border:1px solid var(--card-border);
      border-radius:16px;
      padding:20px;
      box-shadow:0 6px 16px rgba(0,0,0,0.06);
      transition:all .3s ease;
      animation:fadeIn .6s ease;
    }
    .card:hover {
      transform:translateY(-6px);
      box-shadow:0 10px 20px rgba(99,102,241,0.2);
    }
    .card h3 { margin:0 0 12px; font-size:18px; color:var(--primary); }
    .card p { margin:0; color:var(--text-light); font-size:14px; }
    .profile-card {
      background:var(--card-bg);
      border:1px solid var(--card-border);
      padding:24px;
      border-radius:16px;
      box-shadow:0 6px 16px rgba(0,0,0,0.06);
      max-width:640px;
      margin:0 auto;
      animation:fadeIn .6s ease;
    }
    .profile-card h2 { margin-bottom:14px; font-size:22px; font-weight:600; color:var(--primary); }
    .profile-card p { margin:6px 0; color:var(--text-light); font-size:15px; }
    .profile-card button {
      margin-top:16px;
      padding:10px 18px;
      background:var(--primary);
      color:#fff;
      border:none;
      border-radius:10px;
      cursor:pointer;
      font-size:14px;
      font-weight:500;
      transition:all .3s ease;
    }
    .profile-card button:hover {
      background:var(--primary-hover);
      transform:translateY(-2px);
      box-shadow:0 6px 12px rgba(99,102,241,0.3);
    }
    form label { display:block; margin:12px 0 6px; font-size:14px; font-weight:500; color:var(--text-dark); }
    form input {
      width:100%;
      padding:10px;
      margin-bottom:14px;
      border:1px solid var(--card-border);
      border-radius:10px;
      font-size:14px;
      transition:border .2s, box-shadow .2s;
    }
    form input:focus {
      border-color:var(--accent);
      outline:none;
      box-shadow:0 0 0 3px rgba(6,182,212,0.2);
    }
    .save-btn {
      background:#10b981;
      color:#fff;
      padding:10px 18px;
      border:none;
      border-radius:10px;
      cursor:pointer;
      font-size:14px;
      font-weight:500;
      transition:all .3s ease;
    }
    .save-btn:hover {
      background:#059669;
      transform:translateY(-2px);
      box-shadow:0 6px 12px rgba(16,185,129,0.3);
    }
  </style>
</head>
<body>
  <!-- Sidebar -->
  <div class="sidebar">
    <div>
      <h2>üìä Dashboard</h2>
      <div class="menu">
        <button onclick="defaultDashboard()">üè† Home</button>
        <button onclick="loadPredict()">‚ûï New Prediction</button>
        <button onclick="loadHistory()">üìú Prediction History</button>
        <!-- <button id="visualizationsBtn"> Visualizations</button> -->
        <button id="visualizationsBtn" onclick="showVisualizations()">üìä Visualizations</button>
      </div>
    </div>
    <div class="bottom-menu">
      <button onclick="loadProfile()">üë§ Profile</button>
      <button onclick="logout()">üö™ Logout</button>
    </div>
  </div>

  <!-- Main Content -->
  <div class="main" id="content"></div>

  <!-- Page-specific helpers -->
  <script>
    // Redirect if not logged in
    if (!localStorage.getItem("token")) {
      window.location.href = "login.html";
    }

    function defaultDashboard() {
      document.getElementById("content").innerHTML = `
        <div class="welcome">
          <h2>üëã Welcome Back!</h2>
          <p>Select an option from the sidebar to continue.</p>
        </div>
        <div class="dashboard-grid">
          <div class="card"><h3>üìä Stats</h3><p>Check your profile and predictions here.</p></div>
          <div class="card"><h3>‚ö° Quick Action</h3><p>Start new tasks easily with one click.</p></div>
        </div>
      `;
    }

    function logout() {
      localStorage.removeItem("token");
      window.location.href = "login.html";
    }

    function loadHistory() {
      document.getElementById("content").innerHTML = `
        <div class="profile-card">
          <h2>üìú Prediction History</h2>
          <div id="historyTable">Loading...</div>
        </div>
      `;
      fetchHistory(); // comes from history.js
    }

    // Initial view
    defaultDashboard();
  </script>
</body>
</html>
